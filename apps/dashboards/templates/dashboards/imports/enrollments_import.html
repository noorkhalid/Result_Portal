{% extends "dashboards/_layout.html" %}
{% block title %}Import Enrollments (Excel){% endblock %}
{% block content %}
<div class="d-flex align-items-end justify-content-between flex-wrap gap-2 mb-3">
  <div>
    <h3 class="mb-0">Import Enrollments (Excel)</h3>
    <div class="text-muted">Upload .xlsx to enroll students into a program/session.</div>
  </div>
  <a class="btn btn-sm btn-outline-secondary" href="{% url 'admin_enrollment_list' %}">Back</a>
</div>

<div class="card p-4" style="max-width: 900px;">
  <div class="mb-3">
    <a href="{% url 'admin_template_enrollments' %}">Download Excel template</a>
  </div>

  <form method="post" enctype="multipart/form-data" class="row g-3">
    {% csrf_token %}
    <div class="col-12">
      <label class="form-label">Excel File (.xlsx)</label>
      <input type="file" name="file" accept=".xlsx" class="form-control" required>
    </div>
    <div class="col-12">
      <button class="btn btn-primary">Import Enrollments</button>
    </div>
  </form>

  <div class="mt-3 text-muted small">
    Columns required: <code>registration_no</code>, <code>program</code>, <code>session</code>, <code>roll_no</code>. Optional: <code>is_active</code>.<br>
    Notes: <code>program</code> matches by name (contains), <code>session</code> is the session start year (e.g., 2024).
  </div>
</div>
{% endblock %}
