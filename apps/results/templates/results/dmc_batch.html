{% load static %}
{% load results_extras %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    @page { size: A4 portrait; margin: 16mm 14mm; }

    body{
      font-family: "Times New Roman", serif;
      font-size: 12px;
      color:#000;
    }

    .page{
      position: relative;
    }

    .header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      margin-top:4px;
    }
    .header .left,
    .header .right{
      width:40%;
      font-weight:700;
      font-size: 24px;
      letter-spacing: .5px;
    }
    .header .left{ text-align:left; }
    .header .right{ text-align:right; }

    .header .mid{
      width:20%;
      text-align:center;
    }

    .logo{
      width:70px;
      height:auto;
      margin-top:-4px;
    }

    .subright{
      font-style: italic;
      font-weight:700;
      font-size: 16px;
      margin-top:4px;
    }

    .center{
      text-align:center;
    }

    .grade-card{
      font-weight:700;
      font-size: 18px;
      margin-top:10px;
    }

    .program-line{
      font-weight:700;
      font-size: 18px;
      margin-top:2px;
    }

    .session-line{
      font-weight:700;
      font-size: 16px;
      margin-top:2px;
    }

    .dept-line{
      font-weight:700;
      font-size: 15px;
      margin-top:2px;
    }

    table{
      border-collapse: collapse;
    }

    table.student{
      width:100%;
      margin-top:14px;
      font-size: 14px;
    }
    table.student td{
      border:1px solid #000;
      padding:8px 10px;
      vertical-align:middle;
    }
    table.student .label{
      width:18%;
    }
    table.student .value{
      width:32%;
      font-weight:700;
    }

    table.marks{
      width:100%;
      margin-top:18px;
      font-size: 14px;
      table-layout: fixed;
    }
    table.marks th, table.marks td{
      border:1px solid #000;
      padding:10px 8px;
      vertical-align:middle;
    }
    table.marks th{
      font-weight:700;
      text-align:center;
    }
    table.marks td{
      text-align:center;
    }
    table.marks td.title{
      text-align:left;
    }

    .footer{
      margin-top:18px;
      display:flex;
      justify-content:space-between;
      gap:16px;
      align-items:flex-end;
    }

    table.summary{
      width:48%;
      font-size: 14px;
    }
    table.summary td{
      border:1px solid #000;
      padding:6px 10px;
    }
    table.summary td.value{
      width:40%;
      text-align:center;
      font-weight:700;
    }

    .errors{
      margin-top:10px;
      font-style: italic;
      font-size: 13px;
    }

    .sig{
      width:48%;
      text-align:center;
      font-size: 14px;
      font-weight:700;
      padding-bottom:8px;
    }

    .page-break{ page-break-after: always; }
  </style>
</head>
<body>

{% for d in dmcs %}
  <div class="page">
    <div class="header">
      <div class="left">GOMAL UNIVERSITY</div>
      <div class="mid">
        <img class="logo" src="{% static 'img/university_logo.png' %}" alt="Logo">
      </div>
      <div class="right">
        DERA ISMAIL KHAN
        <div class="subright">( Khyber Pakhtunkhwa . Pakistan)</div>
      </div>
    </div>

    <div class="center grade-card">GRADE CARD</div>

    <div class="center program-line">
      {{ batch.program.name }}, {{ batch.semester_number|ordinal }} Semester
    </div>
    <div class="center session-line">Session : {{ session_display }}</div>
    <div class="center dept-line">{{ batch.program.department.name }}</div>

    <table class="student">
      <tr>
        <td class="label">Roll No.</td>
        <td class="value">{{ d.enrollment.roll_no }}</td>
        <td class="label">Registration No.</td>
        <td class="value">{{ d.student.registration_no }}</td>
      </tr>
      <tr>
        <td class="label">Name:</td>
        <td class="value">{{ d.student.name }}</td>
        <td class="label">Father&rsquo;s Name</td>
        <td class="value">{{ d.student.father_name }}</td>
      </tr>
    </table>

    <table class="marks">
      <thead>
        <tr>
          <th style="width:46%">Title</th>
          <th style="width:9%">Credit<br>Hours</th>
          <th style="width:9%">Marks %</th>
          <th style="width:9%">Grade</th>
          <th style="width:9%">N.G.</th>
          <th style="width:18%">G.P=<br>(C.H X N.G)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in d.course_rows %}
          <tr>
            <td class="title">{{ row.title }}</td>
            <td>{{ row.credit_hours|floatformat:0 }}</td>
            <td>{{ row.marks_pct|floatformat:2 }}</td>
            <td>{{ row.grade }}</td>
            <td>{{ row.ng|floatformat:2 }}</td>
            <td>{{ row.gp_total|floatformat:2 }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="footer">
      <div>
        <table class="summary">
          {% for sem_no, gpa in d.gpa_history %}
            <tr>
              <td>GPA of {{ sem_no|ordinal }} Semester</td>
              <td class="value">{{ gpa|floatformat:2 }}</td>
            </tr>
          {% endfor %}

          {% if show_cgpa %}
            <tr>
              <td>CGPA upto {{ batch.semester_number|ordinal }} Semester</td>
              <td class="value">{{ d.semester_result.cgpa|floatformat:2 }}</td>
            </tr>
          {% endif %}

          <tr>
            <td>Grade</td>
            <td class="value">{{ d.semester_result.letter_grade }}</td>
          </tr>
          <tr>
            <td>Remarks</td>
            <td class="value">{{ d.semester_result.remarks }}</td>
          </tr>
          <tr>
            <td>Date of Result</td>
            <td class="value">{{ batch.notification_date|date:"d/m/Y" }}</td>
          </tr>
        </table>

        <div class="errors">Errors and Omission Accepted.</div>
      </div>

      <div class="sig">
        <div style="height:52px;"></div>
        <div>Controller of Examinations</div>
        <div>Gomal University D.I.Khan</div>
      </div>
    </div>
  </div>

  {% if not forloop.last %}
    <div class="page-break"></div>
  {% endif %}
{% endfor %}

</body>
</html>
